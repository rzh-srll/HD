<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HD Employee Time & Payroll System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles */
        .dashboard-card {
            transition: all 0.3s ease;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .punch-animation {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        /* Toggle switch for dark mode */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #68D391;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #68D391;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 transition-colors duration-300">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header with restaurant branding -->
        <header class="flex justify-between items-center mb-10">
            <div>
                <h1 class="text-3xl font-bold text-gray-800 dark:text-white">HUNDRED DEGREES</h1>
                <p class="text-gray-600 dark:text-gray-300">Employee Time & Payroll System</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center">
                    <span class="mr-2 text-gray-700 dark:text-gray-300">Dark Mode</span>
                    <div class="relative inline-block w-10 mr-2 align-middle select-none">
                        <input type="checkbox" id="toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                        <label for="toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                    </div>
                </div>
                <div>
                    <img src="https://placehold.co/50x50" alt="Circular logo icon for Savoria restaurant featuring a chef hat and fork design in gold and burgundy colors" class="rounded-full h-10 w-10 object-cover">
                </div>
            </div>
        </header>

        <!-- Dashboard Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-300">Active Employees</h3>
                    <div class="bg-green-100 dark:bg-green-900 rounded-full p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                    </div>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 dark:text-white" id="active-employees">0</h2>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Currently working</p>
            </div>
            
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-300">Total Hours Today</h3>
                    <div class="bg-blue-100 dark:bg-blue-900 rounded-full p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 dark:text-white" id="total-hours">0</h2>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Hours worked today</p>
            </div>
            
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-300">Payroll Due</h3>
                    <div class="bg-orange-100 dark:bg-orange-900 rounded-full p-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-600 dark:text-orange-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 dark:text-white" id="payroll-due">PHP 0.00</h2>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Current pay period</p>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Time Clock Section -->
            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800 dark:text-white">Employee Time Clock</h2>
                    <div class="flex items-center">
                        <span id="current-time" class="font-mono text-gray-600 dark:text-gray-400 text-lg"></span>
                        <span id="current-date" class="ml-2 text-gray-500 dark:text-gray-500 text-sm"></span>
                    </div>
                </div>

                <div class="mb-6">
                    <label for="employee-select" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Select Employee</label>
                    <select id="employee-select" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">-- Select Employee --</option>
                        <!-- Options will be added by JavaScript -->
                    </select>
                </div>

                <div class="flex flex-col space-y-4 md:space-y-0 md:flex-row md:space-x-4 mb-6">
                    <button id="clock-in-btn" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-4 rounded-lg transition-all duration-300 flex items-center justify-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                        </svg>
                        <span>Clock In</span>
                    </button>
                    <button id="clock-out-btn" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-4 rounded-lg transition-all duration-300 flex items-center justify-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
                        </svg>
                        <span>Clock Out</span>
                    </button>
                </div>

                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg mb-6">
                    <h3 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">Today's Status</h3>
                    <div id="today-status" class="text-gray-600 dark:text-gray-400">No activity recorded yet today.</div>
                </div>

                <div class="overflow-x-auto">
                    <h3 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-3">Recent Activity</h3>
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Employee</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Action</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Time</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="activity-table-body">
                            <!-- Activity rows will be added by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Payroll Calculator Section -->
            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md">
                <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-6">Payroll Calculator</h2>
                
                <div class="mb-4">
                    <label for="pay-period-start" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Pay Period Start</label>
                    <input type="date" id="pay-period-start" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <div class="mb-4">
                    <label for="pay-period-end" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Pay Period End</label>
                    <input type="date" id="pay-period-end" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                
                <button id="calculate-payroll-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 mb-6 flex items-center justify-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                    </svg>
                    <span>Calculate Payroll</span>
                </button>
                
                <div id="payroll-results" class="hidden">
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4">
                        <h3 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">Payroll Summary</h3>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-gray-600 dark:text-gray-400">Regular Hours:</span>
                            <span id="regular-hours" class="font-medium">0</span>
                        </div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-gray-600 dark:text-gray-400">Overtime Hours:</span>
                            <span id="overtime-hours" class="font-medium">0</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600 dark:text-gray-400">Total Employees:</span>
                            <span id="total-employees-payroll" class="font-medium">0</span>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                        <h3 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">Amount Due</h3>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-gray-600 dark:text-gray-400">Regular Pay:</span>
                            <span id="regular-pay" class="font-medium">PHP 0.00</span>
                        </div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-gray-600 dark:text-gray-400">Overtime Pay:</span>
                            <span id="overtime-pay" class="font-medium">PHP 0.00</span>
                        </div>
                        <div class="flex justify-between items-center border-t border-gray-200 dark:border-gray-600 pt-2 mt-2">
                            <span class="text-gray-800 dark:text-gray-200 font-semibold">Total:</span>
                            <span id="total-pay" class="text-blue-600 dark:text-blue-400 font-bold">PHP 0.00</span>
                        </div>
                    </div>
                    
                    <button id="print-payroll-btn" class="w-full mt-4 bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 flex items-center justify-center space-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                        </svg>
                        <span>Print Payroll</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Employee Management Section -->
        <div class="mt-12 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-gray-800 dark:text-white">Employee Management</h2>
                <button id="add-employee-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                    </svg>
                    <span>Add Employee</span>
                </button>
            </div>

            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                    <thead class="bg-gray-50 dark:bg-gray-700">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Name</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Position</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Hourly Rate</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700" id="employee-table-body">
                        <!-- Employee rows will be added by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add Employee Modal -->
        <div id="add-employee-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white">Add New Employee</h3>
                    <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label for="employee-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Full Name</label>
                        <input type="text" id="employee-name" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div>
                        <label for="employee-position" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Position</label>
                        <input type="text" id="employee-position" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    
                    <div>
                        <label for="employee-rate" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hourly Rate (PHP)</label>
                        <input type="number" id="employee-rate" min="50.00" step="0.25" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500" value="50.00">
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end space-x-3">
                    <button id="cancel-add-btn" class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors">
                        Cancel
                    </button>
                    <button id="save-employee-btn" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors">
                        Save Employee
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dark mode toggle
        const toggle = document.getElementById('toggle');
        const body = document.body;
        
        // Check for saved user preference or use browser preference
        if (localStorage.getItem('darkMode') === 'true' || 
            (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            body.classList.add('dark');
            toggle.checked = true;
        }
        
        toggle.addEventListener('change', function() {
            if (this.checked) {
                body.classList.add('dark');
                localStorage.setItem('darkMode', 'true');
            } else {
                body.classList.remove('dark');
                localStorage.setItem('darkMode', 'false');
            }
        });
        
        // Sample employee data
        let employees = [
            { id: 1, name: "Tyron", position: "Accounting", hourlyRate: 60.00, isClockedIn: false },
            { id: 2, name: "Andrei", position: "Sales Team", hourlyRate: 60.00, isClockedIn: false },
            { id: 3, name: "Kevin", position: "Barista", hourlyRate: 50.00, isClockedIn: false },
        ];
        
        // Time tracking data
        let timeRecords = [
            // Sample records
        ];
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateClock();
            setInterval(updateClock, 1000);
            
            populateEmployeeDropdown();
            updateEmployeeTable();
            updateActivityTable();
            updateDashboardStats();
            updateTodayStatus();
            
            // Set default dates for payroll calculation
            const payPeriodStart = new Date(2025, 7, 1); // Month is 0-indexed (7 for August)
            const payPeriodEnd = new Date(2025, 7, 31); // Month is 0-indexed (7 for August)
            document.getElementById('pay-period-start').valueAsDate = payPeriodStart;
            document.getElementById('pay-period-end').valueAsDate = payPeriodEnd;
            
            // Event listeners
            document.getElementById('clock-in-btn').addEventListener('click', clockInEmployee);
            document.getElementById('clock-out-btn').addEventListener('click', clockOutEmployee);
            document.getElementById('calculate-payroll-btn').addEventListener('click', calculatePayroll);
            document.getElementById('print-payroll-btn').addEventListener('click', printPayroll);
            
            // Employee management
            document.getElementById('add-employee-btn').addEventListener('click', () => {
                document.getElementById('add-employee-modal').classList.remove('hidden');
            });
            
            document.getElementById('close-modal-btn').addEventListener('click', closeAddEmployeeModal);
            document.getElementById('cancel-add-btn').addEventListener('click', closeAddEmployeeModal);
            document.getElementById('save-employee-btn').addEventListener('click', saveNewEmployee);
            
            // Populate employee dropdown with current employees
            function populateEmployeeDropdown() {
                const select = document.getElementById('employee-select');
                select.innerHTML = '<option value="">-- Select Employee --</option>';
                
                employees.forEach(employee => {
                    const option = document.createElement('option');
                    option.value = employee.id;
                    option.textContent = `${employee.name} (${employee.position})`;
                    select.appendChild(option);
                });
            }
            
            // Update the employee table
            function updateEmployeeTable() {
                const tbody = document.getElementById('employee-table-body');
                tbody.innerHTML = '';
                
                employees.forEach(employee => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">${employee.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">${employee.position}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">PHP ${employee.hourlyRate.toFixed(2)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm">
                            <span class="px-2 py-1 rounded-full text-xs ${employee.isClockedIn ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'}">
                                ${employee.isClockedIn ? 'Clocked In' : 'Clocked Out'}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">
                            <button class="text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300 mr-3 edit-employee-btn" data-id="${employee.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                </svg>
                            </button>
                            <button class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 delete-employee-btn" data-id="${employee.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </button>
                        </td>
                    `;
                    
                    tbody.appendChild(row);
                });
                
                // Add event listeners for edit and delete buttons
                document.querySelectorAll('.edit-employee-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const employeeId = parseInt(this.getAttribute('data-id'));
                        editEmployee(employeeId);
                    });
                });
                
                document.querySelectorAll('.delete-employee-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const employeeId = parseInt(this.getAttribute('data-id'));
                        deleteEmployee(employeeId);
                    });
                });
            }
            
            // Update the activity table
            function updateActivityTable() {
                const tbody = document.getElementById('activity-table-body');
                tbody.innerHTML = '';
                
                // Get today's records (last 7 for demo purposes)
                const recentRecords = [...timeRecords]
                    .sort((a, b) => b.timestamp - a.timestamp)
                    .slice(0, 7);
                
                recentRecords.forEach(record => {
                    const employee = employees.find(e => e.id === record.employeeId);
                    if (!employee) return;
                    
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                    
                    const formattedDate = record.timestamp.toLocaleDateString();
                    const formattedTime = record.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">${formattedDate}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-gray-200">${employee.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">
                            <span class="px-2 py-1 rounded-full text-xs ${record.action === 'clock-in' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'}">
                                ${record.action === 'clock-in' ? 'CLOCK IN' : 'CLOCK OUT'}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400">${formattedTime}</td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }
            
            // Update dashboard statistics
            function updateDashboardStats() {
                // Active employees (clocked in)
                const activeEmployees = employees.filter(e => e.isClockedIn).length;
                document.getElementById('active-employees').textContent = activeEmployees;
                
                // Total hours worked today
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const todayRecords = timeRecords.filter(record => {
                    return new Date(record.timestamp).setHours(0, 0, 0, 0) === today.getTime();
                });
                
                let totalHoursToday = 0;
                
                for (const employee of employees) {
                    const employeeRecords = todayRecords.filter(r => r.employeeId === employee.id).sort((a, b) => a.timestamp - b.timestamp);
                    
                    for (let i = 0; i < employeeRecords.length; i += 2) {
                        const clockIn = employeeRecords[i];
                        const clockOut = employeeRecords[i + 1];
                        
                        if (clockIn && clockOut && clockIn.action === 'clock-in' && clockOut.action === 'clock-out') {
                            const timeDiff = (clockOut.timestamp - clockIn.timestamp) / (1000 * 60 * 60);
                            totalHoursToday += timeDiff;
                        } else if (clockIn && clockIn.action === 'clock-in' && clockIn.timestamp <= today && employee.isClockedIn) {
                            // Currently clocked in
                            const timeDiff = (new Date() - clockIn.timestamp) / (1000 * 60 * 60);
                            totalHoursToday += timeDiff;
                        }
                    }
                }
                
                document.getElementById('total-hours').textContent = totalHoursToday.toFixed(1);
                
                // Payroll due (dummy calculation for demo)
                // The initial value is set in the HTML, and this line ensures it remains PHP 0.00 unless calculated
                document.getElementById('payroll-due').textContent = 'PHP 0.00'; 
            }
            
            // Update today's status for the selected employee
            function updateTodayStatus() {
                const select = document.getElementById('employee-select');
                if (!select.value) {
                    document.getElementById('today-status').textContent = "No activity recorded yet today.";
                    return;
                }
                
                const employeeId = parseInt(select.value);
                const employee = employees.find(e => e.id === employeeId);
                if (!employee) return;
                
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const todayRecords = timeRecords.filter(record => {
                    return record.employeeId === employeeId && 
                           new Date(record.timestamp).setHours(0, 0, 0, 0) === today.getTime();
                }).sort((a, b) => a.timestamp - b.timestamp);
                
                if (todayRecords.length === 0) {
                    document.getElementById('today-status').innerHTML = `
                        ${employee.name} has no recorded clock-ins for today yet.
                    `;
                    return;
                }
                
                let statusHTML = `<strong>${employee.name}'s</strong> activity today:<br><br>`;
                let totalHours = 0;
                
                for (let i = 0; i < todayRecords.length; i += 2) {
                    const clockIn = todayRecords[i];
                    const clockOut = todayRecords[i + 1];
                    
                    if (clockIn && clockOut && clockIn.action === 'clock-in' && clockOut.action === 'clock-out') {
                        const timeDiff = (clockOut.timestamp - clockIn.timestamp) / (1000 * 60 * 60);
                        totalHours += timeDiff;
                        
                        const inTime = clockIn.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        const outTime = clockOut.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        
                        statusHTML += `⏱ <u>Shift:</u> ${inTime} - ${outTime} (${timeDiff.toFixed(2)} hours)<br>`;
                    } else if (clockIn && clockIn.action === 'clock-in' && clockIn.timestamp <= today && employee.isClockedIn) {
                        // Currently clocked in
                        const timeDiff = (new Date() - clockIn.timestamp) / (1000 * 60 * 60);
                        totalHours += timeDiff;
                        const inTime = clockIn.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        
                        statusHTML += `⏱ <u>Currently clocked in since:</u> ${inTime} (${timeDiff.toFixed(2)} hours so far)<br>`;
                    }
                }
                
                statusHTML += `<br><strong>Total hours today:</strong> ${totalHours.toFixed(1)}`;
                
                document.getElementById('today-status').innerHTML = statusHTML;
            }
            
            // Update the clock display
            function updateClock() {
                const now = new Date();
                
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                const dateString = now.toLocaleDateString([], { weekday: 'long', month: 'short', day: 'numeric' });
                
                document.getElementById('current-time').textContent = timeString;
                document.getElementById('current-date').textContent = dateString;
            }
            
            // Clock in an employee
            function clockInEmployee() {
                const select = document.getElementById('employee-select');
                if (!select.value) {
                    alert('Please select an employee first');
                    return;
                }
                
                const employeeId = parseInt(select.value);
                const employee = employees.find(e => e.id === employeeId);
                
                if (!employee) return;
                
                if (employee.isClockedIn) {
                    alert('This employee is already clocked in!');
                    return;
                }
                
                employee.isClockedIn = true;
                const timestamp = new Date();
                timeRecords.push({ employeeId, action: 'clock-in', timestamp });
                
                // Update UI
                populateEmployeeDropdown();
                updateEmployeeTable();
                updateActivityTable();
                updateDashboardStats();
                updateTodayStatus();
                
                // Visual feedback
                const button = document.getElementById('clock-in-btn');
                button.classList.add('punch-animation');
                setTimeout(() => {
                    button.classList.remove('punch-animation');
                }, 1500);
                
                // Create a notification
                createNotification(`${employee.name} has clocked in`);
            }
            
            // Clock out an employee
            function clockOutEmployee() {
                const select = document.getElementById('employee-select');
                if (!select.value) {
                    alert('Please select an employee first');
                    return;
                }
                
                const employeeId = parseInt(select.value);
                const employee = employees.find(e => e.id === employeeId);
                
                if (!employee) return;
                
                if (!employee.isClockedIn) {
                    alert('This employee is not clocked in!');
                    return;
                }
                
                employee.isClockedIn = false;
                const timestamp = new Date();
                timeRecords.push({ employeeId, action: 'clock-out', timestamp });
                
                // Update UI
                populateEmployeeDropdown();
                updateEmployeeTable();
                updateActivityTable();
                updateDashboardStats();
                updateTodayStatus();
                
                // Visual feedback
                const button = document.getElementById('clock-out-btn');
                button.classList.add('punch-animation');
                setTimeout(() => {
                    button.classList.remove('punch-animation');
                }, 1500);
                
                // Create a notification
                createNotification(`${employee.name} has clocked out`);
            }
            
            // Calculate payroll
            function calculatePayroll() {
                const startDate = new Date(document.getElementById('pay-period-start').value);
                const endDate = new Date(document.getElementById('pay-period-end').value);
                
                if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {
                    alert('Please select valid date range');
                    return;
                }
                
                // Reset end date to end of day
                endDate.setHours(23, 59, 59, 999);
                
                let totalRegularHours = 0;
                let totalOvertimeHours = 0;
                let totalRegularPay = 0;
                let totalOvertimePay = 0;
                
                employees.forEach(employee => {
                    // Get all records for this employee in the date range
                    const employeeRecords = timeRecords
                        .filter(record => {
                            return record.employeeId === employee.id && 
                                   record.timestamp >= startDate && 
                                   record.timestamp <= endDate;
                        })
                        .sort((a, b) => a.timestamp - b.timestamp);
                    
                    let employeeRegularHours = 0;
                    let employeeOvertimeHours = 0;
                    
                    // Calculate hours worked per day
                    const daysWorked = {};
                    employeeRecords.forEach(record => {
                        const dateKey = record.timestamp.toLocaleDateString();
                        if (!daysWorked[dateKey]) {
                            daysWorked[dateKey] = { records: [], totalHours: 0 };
                        }
                        daysWorked[dateKey].records.push(record);
                    });
                    
                    // Process each day
                    for (const date in daysWorked) {
                        const dayRecords = daysWorked[date].records.sort((a, b) => a.timestamp - b.timestamp);
                        let totalDayHours = 0;
                        
                        for (let i = 0; i < dayRecords.length; i += 2) {
                            const clockIn = dayRecords[i];
                            const clockOut = dayRecords[i + 1];
                            
                            if (clockIn && clockOut && clockIn.action === 'clock-in' && clockOut.action === 'clock-out') {
                                const hoursWorked = (clockOut.timestamp - clockIn.timestamp) / (1000 * 60 * 60);
                                totalDayHours += hoursWorked;
                                
                                // Distribute between regular and overtime
                                const overtimeThreshold = 8; // After 8 hours is overtime
                                if (totalDayHours <= overtimeThreshold) {
                                    employeeRegularHours += hoursWorked;
                                } else {
                                    // Some regular, some overtime
                                    const regularPortion = Math.max(0, overtimeThreshold - (totalDayHours - hoursWorked));
                                    const overtimePortion = hoursWorked - regularPortion;
                                    
                                    employeeRegularHours += regularPortion;
                                    employeeOvertimeHours += overtimePortion;
                                }
                            }
                        }
                    }
                    
                    // Add to totals
                    totalRegularHours += employeeRegularHours;
                    totalOvertimeHours += employeeOvertimeHours;
                    
                    // Calculate pay
                    totalRegularPay += employeeRegularHours * employee.hourlyRate;
                    totalOvertimePay += employeeOvertimeHours * employee.hourlyRate * 1.5; // Time and a half for overtime
                });
                
                // Update the UI with results
                document.getElementById('regular-hours').textContent = totalRegularHours.toFixed(1);
                document.getElementById('overtime-hours').textContent = totalOvertimeHours.toFixed(1);
                document.getElementById('total-employees-payroll').textContent = employees.length;
                
                document.getElementById('regular-pay').textContent = `PHP ${totalRegularPay.toFixed(2)}`;
                document.getElementById('overtime-pay').textContent = `PHP ${totalOvertimePay.toFixed(2)}`;
                document.getElementById('total-pay').textContent = `PHP ${(totalRegularPay + totalOvertimePay).toFixed(2)}`;
                
                // Show results
                document.getElementById('payroll-results').classList.remove('hidden');
                
                // Create a notification
                createNotification(`Payroll calculated for ${employees.length} employees`);
            }
            
            // Print payroll (simulated)
            function printPayroll() {
                alert('This would open a print dialog in a real application');
                // In a real app, this would generate a printable report
            }
            
            // Close the add employee modal
            function closeAddEmployeeModal() {
                document.getElementById('add-employee-modal').classList.add('hidden');
                // Clear form
                document.getElementById('employee-name').value = '';
                document.getElementById('employee-position').value = '';
                document.getElementById('employee-rate').value = '50.00';
            }
            
            // Save a new employee
            function saveNewEmployee() {
                const name = document.getElementById('employee-name').value.trim();
                const position = document.getElementById('employee-position').value.trim();
                const rate = parseFloat(document.getElementById('employee-rate').value);
                
                if (!name || !position || isNaN(rate) || rate < 50.00) {
                    alert('Please fill all fields with valid values (minimum wage is PHP 50.00)');
                    return;
                }
                
                // Create new employee
                const newId = Math.max(...employees.map(e => e.id)) + 1;
                const newEmployee = {
                    id: newId,
                    name,
                    position,
                    hourlyRate: rate,
                    isClockedIn: false
                };
                
                employees.push(newEmployee);
                
                // Update UI
                populateEmployeeDropdown();
                updateEmployeeTable();
                updateDashboardStats();
                
                // Close modal and notify
                closeAddEmployeeModal();
                createNotification(`${name} added as new ${position}`);
            }
            
            // Edit employee (stub for example)
            function editEmployee(id) {
                alert(`Edit employee with ID: ${id} would open an edit form in a real application`);
                // In a real app, this would populate the modal with existing data
            }
            
            // Delete employee
            function deleteEmployee(id) {
                if (confirm('Are you sure you want to delete this employee?')) {
                    const employeeIndex = employees.findIndex(e => e.id === id);
                    if (employeeIndex !== -1) {
                        const name = employees[employeeIndex].name;
                        employees.splice(employeeIndex, 1);
                        
                        // Remove all time records for this employee
                        timeRecords = timeRecords.filter(r => r.employeeId !== id);
                        
                        // Update UI
                        populateEmployeeDropdown();
                        updateEmployeeTable();
                        updateActivityTable();
                        updateDashboardStats();
                        
                        createNotification(`${name} removed from system`);
                    }
                }
            }
            
            // Create a notification
            function createNotification(message) {
                // In a real app, this would show a styled notification
                console.log(`Notification: ${message}`);
            }
            
            // Update today status when dropdown changes
            document.getElementById('employee-select').addEventListener('change', updateTodayStatus);
        });
    </script>
</body>
</html>



